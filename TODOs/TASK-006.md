# TASK-006: CI/CD Pipeline

## Описание
Настроить полноценный CI/CD пайплайн с автоматическими проверками качества кода, тестированием и сборкой.

## Реализация ✅

### 1. GitHub Actions Workflow (.github/workflows/ci.yml)
Создан многоэтапный CI пайплайн:

**Jobs:**
- **Lint**: Проверка кода с golangci-lint и staticcheck
- **Test**: Запуск тестов с race detector и покрытием
- **Build**: Кросс-компиляция для разных платформ
- **Security**: Сканирование уязвимостей (gosec, govulncheck)
- **Docker**: Сборка Docker образа (только для main ветки)

**Особенности:**
- Кеширование Go модулей для ускорения сборки
- Сервисы MariaDB и Redis для интеграционных тестов
- Загрузка отчёта покрытия в Codecov
- Матричная сборка для Linux/Windows/macOS (amd64/arm64)
- SARIF отчёты для GitHub Security

### 2. Конфигурация golangci-lint (.golangci.yml)
Настроено 40+ линтеров для проверки:
- Форматирование и стиль кода
- Обнаружение ошибок и уязвимостей
- Производительность и best practices
- Сложность кода и дублирование

**Ключевые линтеры:**
- gosec - безопасность
- govet - подозрительные конструкции
- errcheck - проверка обработки ошибок
- staticcheck - статический анализ
- gocritic - стилистические улучшения

### 3. Makefile
Создан удобный Makefile с командами:

**Основные команды:**
- `make build` - сборка бинарника
- `make test` - запуск тестов
- `make lint` - проверка линтерами
- `make dev` - hot reload разработка
- `make check` - полная проверка

**Дополнительные команды:**
- `make test-coverage` - тесты с отчётом покрытия
- `make bench` - запуск бенчмарков
- `make security` - проверка безопасности
- `make docker-build` - сборка Docker образа
- `make tools` - установка инструментов разработки

### 4. Hot Reload (.air.toml)
Настроен air для автоматической пересборки при изменениях:
- Отслеживание .go файлов
- Исключение тестов и сгенерированных файлов
- Задержка 1 секунда перед пересборкой

## Интеграция

1. **Локальная разработка:**
   ```bash
   make dev     # Запуск с hot reload
   make check   # Проверка перед коммитом
   ```

2. **CI на GitHub:**
   - Автоматически запускается при push/PR
   - Блокирует мерж при провале проверок

3. **Инструменты разработки:**
   ```bash
   make tools   # Установка всех инструментов
   ```

## Метрики качества

Пайплайн обеспечивает:
- ✅ Единый стиль кода
- ✅ Отсутствие распространённых ошибок
- ✅ Обнаружение race conditions
- ✅ Проверка уязвимостей
- ✅ Покрытие тестами

## Файлы
- `.github/workflows/ci.yml` - GitHub Actions workflow
- `.golangci.yml` - конфигурация линтеров
- `Makefile` - команды разработки
- `.air.toml` - конфигурация hot reload

## Статус
✅ Done (2025-06-20)

## История изменений
- 2025-06-20: Задача создана
- 2025-06-20: Создан GitHub Actions workflow
- 2025-06-20: Настроен golangci-lint
- 2025-06-20: Создан Makefile и air config
- 2025-06-20: Задача завершена 