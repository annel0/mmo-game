# TASK-008: Regional Node Architecture

## –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
–ü–æ—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–∑–ª—ã (RegionalNode) —Å –º—è–≥–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π (eventual consistency) –¥–ª—è PvE-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ MMO. –¶–µ–ª—å ‚Äî –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∏–∑–∫—É—é –∑–∞–¥–µ—Ä–∂–∫—É –±–µ–∑ —Å—Ç—Ä–æ–≥–æ–π –≥–ª–æ–±–∞–ª—å–Ω–æ–π –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏.

## –¶–µ–ª–∏
1. –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä (primary + backups) –≤ –∫–∞–∂–¥–æ–º –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º —Ä–µ–≥–∏–æ–Ω–µ.
2. –õ–æ–∫–∞–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –∏–≥—Ä–æ–∫–æ–≤ (optimistic updates) —Å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π –æ—Ç–¥–∞—á–µ–π.
3. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –¥—Ä—É–≥–∏–µ —Ä–µ–≥–∏–æ–Ω—ã –∫–∞–∂–¥—ã–µ 1-5 —Å.
4. –ü—Ä–æ—Å—Ç–æ–π ConflictResolver (Last-Write-Wins + —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤).
5. –ú–µ—Ç—Ä–∏–∫–∏ –∑–∞–¥–µ—Ä–∂–µ–∫ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.

## –§–∞–π–ª—ã/–ü–∞–ø–∫–∏
- `internal/network/regional/` ‚Äî –Ω–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —É–∑–ª–æ–≤ –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
- `internal/sync/` ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä eventual consistency
- `cmd/server/main.go` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞
- –¢–µ—Å—Ç—ã: `tests/regional_node_test.go`

## –ü–æ–¥–∑–∞–¥–∞—á–∏
1. [ ] –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `RegionalNode` –∏ `RegionalCluster`.
2. [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `LocalWorldState` —Å in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π.
3. [ ] –°–æ–∑–¥–∞—Ç—å `EventualSyncManager` –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏.
4. [ ] –î–æ–±–∞–≤–∏—Ç—å `SimpleConflictResolver` (LWW + –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ).
5. [ ] –ú–µ—Ç—Ä–∏–∫–∏ –≤ Prometheus: `replication_delay_seconds`, `conflict_total`.
6. [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º `WorldManager` (—á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–µ—Ä).
7. [ ] E2E —Ç–µ—Å—Ç: –¥–≤–∞ —Ä–µ–≥–∏–æ–Ω–∞, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ.
8. [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `EventBus` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å + Embedded NATS JetStream (–≤–Ω—É—Ç—Ä–∏ —É–∑–ª–∞).
9. [ ] –î–∞—à–±–æ—Ä–¥ Prometheus/Grafana: –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏ –∑–∞–¥–µ—Ä–∂–µ–∫.

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç
P1

## –°–ª–æ–∂–Ω–æ—Å—Ç—å
4/5

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚Äî

## –°—Ç–∞—Ç—É—Å
Done

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- 2025-06-21: —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω.
- 2025-06-21: –Ω–∞—á–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–ø—É–Ω–∫—Ç–∞ 8 (EventBus Interface)
- 2025-06-21: –≤—ã–ø–æ–ª–Ω–µ–Ω–æ 8.3 ‚Äì `LoggingListener` (ü™µ) –æ—Ç–ø—Ä–∞–≤–∫–∞ eventbus log
- 2025-06-21: –≤—ã–ø–æ–ª–Ω–µ–Ω–æ 8.4 ‚Äì `MetricsExporter` + `/metrics` Prometheus (üìà) 
- 2025-06-21: –ó–ê–í–ï–†–®–ï–ù–û! –ü–æ–ª–Ω–∞—è Regional Node Architecture —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## –í—ã–ø–æ–ª–Ω–µ–Ω–æ
- 2025-06-21: 8.5 ‚Äì –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è EventBus —á–µ—Ä–µ–∑ YAML (`config.yml`, ENV GAME_CONFIG)
- 2025-06-21: TASK-015 ‚Äì Regional Node Implementation (–ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
- 2025-06-21: TASK-013 ‚Äì Observability Middleware (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
- 2025-06-21: –í—Å–µ E2E —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, —Å–∏—Å—Ç–µ–º–∞ production-ready 